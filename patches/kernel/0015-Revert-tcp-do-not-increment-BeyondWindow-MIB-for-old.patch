From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fabian=20Gr=C3=BCnbichler?= <f.gruenbichler@proxmox.com>
Date: Fri, 19 Dec 2025 08:46:25 +0100
Subject: [PATCH] Revert "tcp: do not increment BeyondWindow MIB for old seq"

This reverts commit b115c7758802f8d14ba8797e0ba979c47d78f310.
---
 net/ipv4/tcp_input.c | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/net/ipv4/tcp_input.c b/net/ipv4/tcp_input.c
index e0057e5aaaf8b25d289cd944302e376e4588bc43..4584884b928742b6e89315d1df22780fba1551d1 100644
--- a/net/ipv4/tcp_input.c
+++ b/net/ipv4/tcp_input.c
@@ -5915,11 +5915,7 @@ static bool tcp_validate_incoming(struct sock *sk, struct sk_buff *skb,
 		if (!th->rst) {
 			if (th->syn)
 				goto syn_challenge;
-
-			if (reason == SKB_DROP_REASON_TCP_INVALID_SEQUENCE ||
-			    reason == SKB_DROP_REASON_TCP_INVALID_END_SEQUENCE)
-				NET_INC_STATS(sock_net(sk),
-					      LINUX_MIB_BEYOND_WINDOW);
+			NET_INC_STATS(sock_net(sk), LINUX_MIB_BEYOND_WINDOW);
 			if (!tcp_oow_rate_limited(sock_net(sk), skb,
 						  LINUX_MIB_TCPACKSKIPPEDSEQ,
 						  &tp->last_oow_ack_time))
